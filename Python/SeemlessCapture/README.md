# SeamlessCapture - 連続スクリーンショットツール

指定した範囲を連続でキャプチャし、PNG画像やPDFファイルとして保存するPythonスクリプトです。

## 機能

- **範囲指定キャプチャ**: マウスで左上と右下を指定して範囲を決定
- **連続キャプチャ**: 指定したページ数分、自動で右矢印キー送信とキャプチャを実行
- **柔軟な保存形式**: PDFのみ、またはPNG+PDF両方保存を選択可能
- **カスタマイズ可能な設定**: 待機時間やファイル名プレフィックスを設定
- **自動桁数調整**: ページ数に応じてファイル名の桁数を自動調整

## 必要なライブラリ

```bash
pip install pyautogui pillow
```

## 使用方法

1. スクリプトを実行
```bash
python SeemlessCapture.py
```

2. **キャプチャ範囲を設定**
   - 5秒以内にキャプチャしたい範囲の左上角にマウスを移動
   - 次に5秒以内に右下角にマウスを移動
   - 範囲を確認してEnterで決定（やり直す場合は'N'を入力）

3. **ページ数を入力**
   - キャプチャしたいページ数を入力（例: 10）

4. **保存形式を選択**
   - `1`: PDFのみ保存（デフォルト）
   - `2`: PNG + PDF両方保存

5. **待機時間を設定**
   - `1`: 高速（0.1秒）- デフォルト
   - `2`: 標準（0.3秒）
   - `3`: 安全（0.5秒）
   - `4`: カスタム（手動入力）

6. **プレフィックス名を入力**
   - ファイル名の先頭に付ける名前を入力
   - 未入力の場合は日付_a形式（例: 20250623_a）

7. **キャプチャ実行**
   - 5秒以内にキャプチャ対象のウィンドウをアクティブにする
   - 自動でキャプチャが開始される

## 出力ファイル

### フォルダ構成
```
プレフィックス名/
├── プレフィックス名_001.png  # PNG保存を選択した場合
├── プレフィックス名_002.png
├── ...
└── プレフィックス名.pdf      # 全ページをまとめたPDF
```

### ファイル名例
- **プレフィックス**: `document`
- **ページ数**: 50
- **出力**: `document_001.png` ～ `document_050.png` + `document.pdf`

## 待機時間の推奨設定

| アプリケーション | 推奨設定 | 理由 |
|------------------|----------|------|
| ウェブブラウザ | 高速（0.1秒） | ページ切り替えが高速 |
| 軽量PDFビューア | 高速（0.1秒） | レスポンスが良い |
| Adobe Reader | 標準（0.3秒） | やや重い処理 |
| PowerPoint | 標準（0.3秒） | アニメーション考慮 |
| 大きなPDF | 安全（0.5秒） | 読み込み時間が必要 |
| 重いアプリ | カスタム（1.0秒～） | 個別調整が必要 |

## 使用例

### 例1: プレゼンテーション資料をPDFで保存
```
キャプチャするページ数: 20
保存形式: 1 (PDFのみ)
待機時間: 2 (標準 0.3秒)
プレフィックス名: presentation
```
→ `presentation/presentation.pdf` が作成される

### 例2: ウェブページを高速キャプチャ
```
キャプチャするページ数: 100
保存形式: 2 (PNG + PDF両方)
待機時間: 1 (高速 0.1秒)
プレフィックス名: webpage
```
→ `webpage/webpage_001.png` ～ `webpage_100.png` + `webpage.pdf` が作成される

## 注意事項

- **キーボードフォーカス**: キャプチャ開始前に対象ウィンドウがアクティブであることを確認
- **待機時間**: アプリケーションの応答速度に合わせて調整
- **権限**: 一部のアプリケーションでは管理者権限が必要な場合があります
- **解像度**: 高解像度環境では処理時間が長くなる場合があります

## トラブルシューティング

### キャプチャが正しく動作しない
- 待機時間を長めに設定する
- 対象ウィンドウがアクティブになっているか確認
- pyautoguiのフェイルセーフ機能（マウスを画面隅に移動で停止）

### ファイルが保存されない
- 書き込み権限があるフォルダか確認
- ディスク容量が十分にあるか確認

### PDFが作成されない
- PIL（Pillow）ライブラリが正しくインストールされているか確認

## ライセンス

このスクリプトは自由に使用・改変できます。

## 更新履歴

- v1.0: 初回リリース
  - 基本的なキャプチャ機能
  - PNG保存機能
- v2.0: PDF機能追加
  - PDF保存機能
  - 保存形式選択機能
  - 待機時間設定機能
  - 自動桁数調整機能
